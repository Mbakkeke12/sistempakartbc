<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Sistem Pakar Diagnosa TBC</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background:#f4f6f9; }
    .sidebar {
      width:250px; min-height:100vh; background:#0d6efd; color:#fff;
    }
    .sidebar a { color:#fff; text-decoration:none; display:block; padding:12px; }
    .sidebar a:hover { background:rgba(255,255,255,0.2); }
    .content { padding:30px; }
    .card { border-radius:15px; }
  </style>
</head>
<body>
<div class="d-flex">
  <!-- Sidebar -->
  <div class="sidebar">
    <h4 class="text-center py-3">Sistem Pakar TBC</h4>
    <a href="#dashboard">Dashboard</a>
    <a href="#info">Info TBC</a>
    <a href="#penyakit">Data Penyakit</a>
    <a href="#gejala">Data Gejala</a>
    <a href="#rule">Rule Dempster-Shafer</a>
    <a href="#diagnosa">Diagnosa</a>
  </div>

  <!-- Content -->
  <div class="content w-100">

    <!-- Dashboard -->
    <section id="dashboard">
      <h2>Dashboard</h2>
      <div class="row mt-4">
        <div class="col-md-4">
          <div class="card shadow p-3">
            <h5>Total Penyakit</h5>
            <p>7 Jenis TBC</p>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card shadow p-3">
            <h5>Total Gejala</h5>
            <p>22 Gejala</p>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card shadow p-3">
            <h5>Metode</h5>
            <p>Dempster Shafer</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Info TBC -->
    <section id="info" class="mt-5">
      <h2>Informasi TBC</h2>
      <div class="card shadow p-4 mt-3">
        <p>Tuberkulosis (TBC) adalah penyakit menular yang disebabkan oleh bakteri <i>Mycobacterium tuberculosis</i>. Penyakit ini terutama menyerang paru-paru, namun juga dapat menyerang organ lain seperti tulang, kelenjar getah bening, dan otak.</p>
      </div>
    </section>

    <!-- Data Penyakit -->
    <section id="penyakit" class="mt-5">
      <h2>Data Penyakit</h2>
      <table class="table table-bordered table-striped mt-3">
        <thead class="table-primary">
          <tr><th>Kode</th><th>Nama Penyakit</th><th>Definisi</th><th>Solusi</th></tr>
        </thead>
        <tbody>
          <tr><td>P01</td><td>TBC Paru</td><td>Infeksi TBC pada paru-paru</td><td>Pemeriksaan dahak dan OAT</td></tr>
          <tr><td>P02</td><td>TBC Ekstra Paru</td><td>Menyerang organ selain paru</td><td>Pemeriksaan lanjutan</td></tr>
          <tr><td>P03</td><td>TBC Milier</td><td>Penyebaran ke seluruh tubuh</td><td>Perawatan intensif</td></tr>
          <tr><td>P04</td><td>MDR-TB</td><td>TBC resisten obat</td><td>Obat lini kedua</td></tr>
          <tr><td>P05</td><td>TBC Laten</td><td>TBC tanpa gejala</td><td>Pemantauan kesehatan</td></tr>
          <tr><td>P06</td><td>TBC Anak</td><td>TBC pada anak</td><td>OAT sesuai usia</td></tr>
          <tr><td>P07</td><td>TBC Tulang & Sendi</td><td>Menyerang tulang dan sendi</td><td>Radiologi & terapi</td></tr>
        </tbody>
      </table>
    </section>

    <!-- Data Gejala -->
    <section id="gejala" class="mt-5">
      <h2>Data Gejala</h2>
      <div class="row mt-3">
        <div class="col-md-6">
          <ul class="list-group">
            <li class="list-group-item">G01 - Batuk berkepanjangan</li>
            <li class="list-group-item">G02 - Demam lama</li>
            <li class="list-group-item">G03 - Berat badan turun</li>
            <li class="list-group-item">G04 - Keringat malam</li>
            <li class="list-group-item">G05 - Nafsu makan menurun</li>
            <li class="list-group-item">G06 - Sesak napas ringan</li>
            <li class="list-group-item">G10 - Nyeri tulang</li>
            <li class="list-group-item">G15 - Kontak penderita TBC</li>
            <li class="list-group-item">G17 - Sesak napas</li>
            <li class="list-group-item">G18 - Riwayat pengobatan TBC gagal</li>
            <li class="list-group-item">G22 - Nyeri tulang belakang</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Rule -->
    <section id="rule" class="mt-5">
      <h2>Rule Dempster-Shafer</h2>
      <div class="card shadow p-4 mt-3">
        <p>Metode Dempster-Shafer digunakan untuk menghitung tingkat kepercayaan diagnosa berdasarkan kombinasi gejala yang dipilih oleh pengguna. Aturan berikut digunakan:</p>
        <ul>
          <li>R1: G01,G03,G04,G05,G06 → TBC Paru (P01)</li>
          <li>R2: G10,G22 → TBC Ekstra Paru (P02)</li>
          <li>R3: G01,G02,G03,G04,G05,G17 → TBC Milier (P03)</li>
          <li>R4: G01,G02,G03,G04,G05,G18 → MDR-TB (P04)</li>
          <li>R5: G15 → TBC Laten (P05)</li>
          <li>R6: G17,G03,G04,G05,G06 → TBC Anak (P06)</li>
          <li>R7: G10,G22 → TBC Tulang & Sendi (P07)</li>
        </ul>
      </div>
    </section>

    <!-- Diagnosa -->
    <section id="diagnosa" class="mt-5">
      <h2>Diagnosa Penyakit</h2>
      <div class="card shadow p-4 mt-3">
        <form id="diagnosaForm">
          <p>Pilih gejala yang Anda alami:</p>
          <div class="form-check">
            <input class="form-check-input gejala" type="checkbox" id="G01" value="G01">
            <label class="form-check-label" for="G01">Batuk lebih dari 2 minggu (G01)</label>
          </div>
          <div class="form-check">
            <input class="form-check-input gejala" type="checkbox" id="G02" value="G02">
            <label class="form-check-label" for="G02">Demam berkepanjangan (G02)</label>
          </div>
          <div class="form-check">
            <input class="form-check-input gejala" type="checkbox" id="G03" value="G03">
            <label class="form-check-label" for="G03">Penurunan berat badan (G03)</label>
          </div>
          <div class="form-check">
            <input class="form-check-input gejala" type="checkbox" id="G04" value="G04">
            <label class="form-check-label" for="G04">Keringat malam (G04)</label>
          </div>
          <div class="form-check">
            <input class="form-check-input gejala" type="checkbox" id="G05" value="G05">
            <label class="form-check-label" for="G05">Nafsu makan menurun (G05)</label>
          </div>
          <div class="form-check">
            <input class="form-check-input gejala" type="checkbox" id="G06" value="G06">
            <label class="form-check-label" for="G06">Sesak napas ringan (G06)</label>
          </div>
          <div class="form-check">
            <input class="form-check-input gejala" type="checkbox" id="G10" value="G10">
            <label class="form-check-label" for="G10">Nyeri tulang (G10)</label>
          </div>
          <div class="form-check">
            <input class="form-check-input gejala" type="checkbox" id="G15" value="G15">
            <label class="form-check-label" for="G15">Kontak penderita TBC (G15)</label>
          </div>
          <div class="form-check">
            <input class="form-check-input gejala" type="checkbox" id="G17" value="G17">
            <label class="form-check-label" for="G17">Sesak napas (G17)</label>
          </div>
          <div class="form-check">
            <input class="form-check-input gejala" type="checkbox" id="G18" value="G18">
            <label class="form-check-label" for="G18">Riwayat pengobatan TBC gagal (G18)</label>
          </div>
          <div class="form-check">
            <input class="form-check-input gejala" type="checkbox" id="G22" value="G22">
            <label class="form-check-label" for="G22">Nyeri tulang belakang (G22)</label>
          </div>
          <button type="button" class="btn btn-primary mt-3" onclick="prosesDiagnosa()">Proses Diagnosa</button>
        </form>
        <div id="hasilDiagnosa" class="mt-3"></div>
      </div>
    </section>

  </div>
</div>

<script>
  // Data penyakit
  const penyakit = {
    'P01': 'TBC Paru',
    'P02': 'TBC Ekstra Paru',
    'P03': 'TBC Milier',
    'P04': 'MDR-TB',
    'P05': 'TBC Laten',
    'P06': 'TBC Anak',
    'P07': 'TBC Tulang & Sendi'
  };

  // Aturan: penyakit -> array gejala
  const rules = {
    'P01': ['G01', 'G03', 'G04', 'G05', 'G06'],
    'P02': ['G10', 'G22'],
    'P03': ['G01', 'G02', 'G03', 'G04', 'G05', 'G17'],
    'P04': ['G01', 'G02', 'G03', 'G04', 'G05', 'G18'],
    'P05': ['G15'],
    'P06': ['G17', 'G03', 'G04', 'G05', 'G06'],
    'P07': ['G10', 'G22']
  };

  function prosesDiagnosa() {
    const selectedGejala = [];
    const checkboxes = document.querySelectorAll('.gejala:checked');
    checkboxes.forEach(cb => selectedGejala.push(cb.value));

    if (selectedGejala.length === 0) {
      document.getElementById('hasilDiagnosa').innerHTML = '<div class="alert alert-warning">Pilih setidaknya satu gejala.</div>';
      return;
    }

    // Hitung skor untuk setiap penyakit (simulasi Dempster-Shafer sederhana: proporsi gejala yang cocok)
    const scores = {};
    for (const [penyakitKode, gejalaRules] of Object.entries(rules)) {
      const matched = gejalaRules.filter(g => selectedGejala.includes(g)).length;
      const total = gejalaRules.length;
      scores[penyakitKode] = total > 0 ? (matched / total) * 100 : 0; // Persentase kecocokan
    }

    // Temukan penyakit dengan skor tertinggi
    let maxScore = 0;
    let diagnosed = [];
    for (const [kode, score] of Object.entries(scores)) {
      if (score > maxScore) {
        maxScore = score;
        diagnosed = [kode];
      } else if (score === maxScore) {
        diagnosed.push(kode);
      }
    }

    // Tampilkan hasil
    let resultHtml = '<div class="alert alert-info"><h5>Hasil Diagnosa:</h5>';
    if (maxScore === 0) {
      resultHtml += '<p>Tidak ada kecocokan yang signifikan dengan penyakit TBC. Konsultasikan dengan dokter.</p>';
    } else {
      resultHtml += '<p>Penyakit yang mungkin: ';
      diagnosed.forEach(kode => {
        resultHtml += `${penyakit[kode]} (${scores[kode].toFixed(2)}% kecocokan), `;
      });
      resultHtml = resultHtml.slice(0, -2) + '.</p>';
      resultHtml += '<p><strong>Catatan:</strong> Ini adalah simulasi berdasarkan aturan Dempster-Shafer sederhana. Hasil ini bukan diagnosis medis resmi. Segera konsultasikan dengan tenaga medis profesional.</p>';
    }
    resultHtml += '</div>';

    document.getElementById('hasilDiagnosa').innerHTML = resultHtml;
  }
</script>

</body>
</html>